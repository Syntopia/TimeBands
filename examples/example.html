<html><body>
<style>
 svg{
        font-family: Helvetica, Arial;
		    -webkit-user-select: none;  /* Chrome all / Safari all */
    -moz-user-select: none;     /* Firefox all */
    -ms-user-select: none;      /* IE 10+ */
    }
</style>
<svg width="1600" height="580" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <linearGradient id="grad1" x1="0%" y1="30%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:rgb(255,255,255);stop-opacity:1" />
      <stop offset="100%" style="stop-color:rgb(225,255,225);stop-opacity:1" />
    </linearGradient>
    <linearGradient id="grad3" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:rgb(245,245,235);stop-opacity:1" />
      <stop offset="100%" style="stop-color:rgb(225,225,225);stop-opacity:1" />
    </linearGradient>
    <linearGradient id="grad2" x1="0%" y1="30%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:rgb(255,255,255);stop-opacity:1" />
      <stop offset="100%" style="stop-color:rgb(225,225,255);stop-opacity:1" />
    </linearGradient>
  </defs>
	<g id="svgtop"></g>
	<g id="svgbottom">
	</g>
</svg>

<script src="../source/Viewport.js" ></script>
<script src="../source/Band.js" ></script>
<script src="../source/TimeBand.js" ></script>
<script src="../source/timebands.js" ></script>
<script src="../source/timebandsparser.js" ></script>


<pre id="text">
Mikael
------
1/2-5/6: test
7/6-17/6: momo

Juno
----
8/9-10/10: teso

Phases
------
1/1-1/5: Implementation
1/5-1/6: Test
1/6-1/10: Implementation
1/10-31/12: Test


</pre>

<script>


var svg = document.getElementsByTagName('svg')[0]; //Get svg element

function init() {
	var startDate = new Date(2015,0,1);
	var view = new Viewport(svg);
	var top = svg.getElementById('svgtop');
	console.log(top);
	var monthNames = ["Jan", "Feb", "Mar",
				 "Apr", "May", "Jun", "Jul",
				"Aug", "Sep", "Oct",
				"Nov", "Dec"];
	var mc2 = ["#DEF", "#ACE","#DEF",
				"#CDA", "#EED", "#CDA",
				"#FED", "#EDA", "#FED",
				"#FC9", "#FEC", "#FC9"];
	var mc = ["#FC9", "#FEC", "#FC9",
				"#CDA", "#EED", "#CDA",
				"#FC9", "#FEC", "#FC9",
				"#CDA", "#EED", "#CDA"];

	var tb = new TimeBand(svg,2015,0);
	var style = new TextBoxStyle();

	var months = [];
	var lastMonth = -1;
	var days = new Band(tb,13);
	style.fontSize=10;
	for (var x = 0; x < 365; x++) {
		var d = new Date(tb.startYear,tb.startMonth,x+1) ;
		if (d.getMonth()!=lastMonth) {
			months.push(x);
			lastMonth = d.getMonth();
		}
		days.add(x,x+1, d.getDate(), style, d+"");
	}
	months.push(365);

	style.fontSize=18;

	var weeks = new Band(tb);
	for (var x = 0; x < 52; x++) {
		style.bgfill = (x % 2 == 1) ? "none" : "#eee";
		style.textFill = (x % 2 == 0) ? "#fff" : "#fff";
		weeks.add(x*7, x*7+7, ""+(x+1), style);
	}

	var monthsBand = new Band(tb);
	for (var i = 0; i < months.length-1; i++) {
		var x = months[i];
		var x2 = months[i+1];
		var d = new Date(tb.startYear,tb.startMonth,x+1) ;
		style.bgfill = mc[d.getMonth()];
		monthsBand.add(x, x2, monthNames[d.getMonth()], style);
	}

	var spacing = 7;
	var height = 30;

	new Band(tb,spacing);

	var b = new Band(tb,height, "John Doe");
	var ss = new TextBoxStyle();
	ss.fontSize = 20;
	ss.rx = 3;
	ss.ry = 3;
	ss.bgfill = "url(#grad3)";
		b.add(10,100, "Implementation", ss);
	b.add(110,200, "ISSUES-32", ss);

	new Band(tb,spacing);

	b = new Band(tb,height, "Random Person");
		b.add(50,80, "Design", ss);
	b.add(150,240, "Arch review", ss);

	new Band(tb,spacing);

	b = new Band(tb,height, "Syntopia");
	b.add(30,140, "Test", ss);
	b.add(190,240, "Consolidation", ss);

	var t = document.getElementById('text');
	var parser = new TimeBandsParser();
	parser.parse(t.innerText);
	for (var i = 0; i < parser.bandSections.length; i++) {
		var bs = parser.bandSections[i];
		new Band(tb,spacing);
		b = new Band(tb,height, bs.name);
		if (bs.name.startsWith("Phases")) {
			ss.section = true;

		}
		for (var j = 0; j < bs.entries.length; j++) {
			if (ss.section) ss.bgfill = (j % 2 == 0) ? "url(#grad1)" : "url(#grad2)";
			var e = bs.entries[j];
			var interval = e.getIntervalRelativeToDate(startDate);
			b.add(interval[0],interval[1], e.name, ss);
		}

	}

	view.scalableElements = tb.scalableElements;

}

svg.addEventListener("load",function() {
	init();
}, false);


function mix(x,y,a) {
	return x*(1-a)+y*a;
}



</script>

</body></html>
