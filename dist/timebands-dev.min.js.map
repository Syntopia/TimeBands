{"version":3,"sources":["TextBoxStyle.js","Viewport.js","Band.js","TimeBand.js","timebands.js","timebandsparser.js"],"names":["TextBoxStyle","this","rx","ry","strokeWidth","textStroke","textStrokeWidth","opacity","bgfill","textFill","fontSize","section","Viewport","svg","zoom","centerX","scalableElements","self","addEventListener","e","mouseWheel","mouseDown","mouseUp","mouseMove","prototype","dragging","rect","getBoundingClientRect","mX","clientX","left","clientY","top","centerXDown","mouseDownX","redraw","mouseDownY","dirty","ScaleInfo","textWidth","rectWidth","getRatio","rescale","getElementById","transform","replace","setAttribute","width","undefined","scaleMap","Map","i","length","rectNode","childNodes","textNode","getBBox","set","scaleInfo","get","ratio","factor","deltaY","preventDefault","dx","from","dx2","Band","timeBand","height","name","defaultBandHeight","yOffset","infos","addBand","s","bottom","g","add","constructor","init","canvasID","addListeners","fromDay","toDay","text","style","hint","target","y","h","groupElement","timebands","addBox","cellWidth","push","boxClicked","boxMouseover","boxMouseout","console","log","stroke","originalStroke","TimeBand","startYear","startMonth","numberOfDays","view","ne","document","createElementNS","l1","createLinearGradient","appendChild","createStop","l2","l3","ne2","ne3","nextYOffset","bands","monthNames","monthColors2","monthColors","band","addHeader","tb","months","weeks","weeksNumbers","lastMonth","lastWeek","days","x","d","Date","getMonth","week","getWeekNumber","getDate","weeksBand","monthsBand","x2","REVISION","dateDiffInDays","a","b","utc1","UTC","getFullYear","utc2","Math","floor","setHours","setDate","getDay","ceil","id","x1","y1","y2","offset","w","fill","originalStrokeWidth","t","fontfamily","textContent","ti","hasChildNodes","children","insertBefore","defs","startDate","spacing","ss","parser","TimeBandsParser","parse","innerHTML","bandSections","bs","startsWith","substr","j","entries","interval","getIntervalRelativeToDate","create","svgID","defsID","BandEntry","to","date","f","BandSection","toString","addEntry","TimeParser","implicitYear","parseInterval","l","split","parseTime","trim","timeParser","addBandSection","parseEntry","txt","lines","match","bandSection"],"mappings":"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","file":"timebands-dev.min.js","sourcesContent":["var TextBoxStyle = function() {\r\n    this.rx = 0;\r\n    this.ry = 0;\r\n    this.strokeWidth = 0.2;\r\n    this.textStroke = \"#000\";\r\n    this.textStrokeWidth = 0;\r\n    this.opacity = 1;\r\n    this.bgfill = \"white\";\r\n    this.textFill = \"#000\";\r\n    this.fontSize = 18;\r\n    this.section = false;\r\n};\r\n","var Viewport = function(svg) {\n\tthis.zoom = 1.0;\n\tthis.centerX = 0.0;\n\tthis.svg = svg;\n\tthis.scalableElements = [];\n\tvar self = this;\n\tthis.svg.addEventListener('wheel', function(e) {\n\t\tself.mouseWheel(e);\n\t}, false);\n\tthis.svg.addEventListener('mousedown', function(e) {\n\t\tself.mouseDown(e);\n\t}, false);\n\tthis.svg.addEventListener('mouseup', function(e) {\n\t\tself.mouseUp(e);\n\t}, false);\n\tthis.svg.addEventListener('mousemove', function(e) {\n\t\tself.mouseMove(e);\n\t}, false);\n}\n\nViewport.prototype.mouseUp = function(e) {\n\tthis.dragging = false;\n}\n\nViewport.prototype.mouseMove = function(e) {\n\tif (this.dragging) {\n\t\tvar rect = svg.getBoundingClientRect();\n\t\tvar mX = e.clientX - rect.left;\n\t\tvar mY = e.clientY - rect.top;\n\t\tthis.centerX = this.centerXDown + 2.0 * (mX - this.mouseDownX) / this.zoom;\n\t\tthis.redraw(false, e);\n\t}\n}\n\nViewport.prototype.mouseDown = function(e) {\n\tvar rect = svg.getBoundingClientRect();\n\tthis.mouseDownX = e.clientX - rect.left;\n\tthis.mouseDownY = e.clientY - rect.top;\n\tthis.centerXDown = this.centerX;\n\tthis.dragging = true;\n\tthis.dirty = true;\n}\n\nvar ScaleInfo = function(textWidth, rectWidth) {\n\tthis.textWidth = textWidth;\n\tthis.rectWidth = rectWidth;\n\tthis.getRatio = function() {\n\t\treturn rectWidth / textWidth;\n\t}\n}\n\nViewport.prototype.redraw = function(rescale, e) {\n\tvar top = svg.getElementById('svgtop');\n\tvar transform = \"matrix(sx 0 0 1 tx 0)\".replace(\"sx\", this.zoom).replace(\"tx\", this.centerX * this.zoom);\n\ttop.setAttribute(\"transform\", transform);\n\n\tvar rect = svg.getBoundingClientRect();\n\tvar mX = e.clientX - rect.left;\n\tvar w = svg.getBoundingClientRect().width;\n\tvar dx = mX * this.zoom;\n\tvar from = -this.centerX;\n\t//console.log(\"From: \" + from + \" to: \" + (from + w / this.zoom) + \" me:\" + (from + (mX / this.zoom)));\n\n\tif (!rescale) return;\n\n\tif (this.scaleMap === undefined) {\n\t\tthis.scaleMap = new Map();\n\t\tfor (var i = 0; i < this.scalableElements.length; i++) {\n\t\t\tvar rectNode = this.scalableElements[i].childNodes[0];\n\t\t\tvar textNode = this.scalableElements[i].childNodes[1];\n\t\t\tvar width = textNode.getBBox().width + 5;\n\t\t\tvar rectWidth = rectNode.getBBox().width;\n\t\t\tthis.scaleMap.set(this.scalableElements[i], new ScaleInfo(width, rectWidth));\n\t\t}\n\t}\n\n\tfor (var i = 0; i < this.scalableElements.length; i++) {\n\t\tvar rectNode = this.scalableElements[i].childNodes[0];\n\t\tvar textNode = this.scalableElements[i].childNodes[1];\n\t\ttextNode.setAttribute(\"transform\", \"scale(\" + (1 / this.zoom) + \",1)\");\n\t\tvar scaleInfo = this.scaleMap.get(this.scalableElements[i]);\n\t\tvar ratio = scaleInfo.getRatio() * this.zoom;\n\n\t\tvar opacity = 1;\n\t\tif (scaleInfo.rectWidth * this.zoom < 5) {\n\t\t\trectNode.setAttribute(\"visibility\", \"hidden\");\n\t\t} else {\n\t\t\trectNode.setAttribute(\"visibility\", \"visibility\");\n\t\t}\n\t\tif (ratio < 0.3) {\n\t\t\ttextNode.setAttribute(\"visibility\", \"hidden\");\n\t\t} else {\n\t\t\ttextNode.setAttribute(\"visibility\", \"visibility\");\n\t\t\tif (ratio < 1) {\n\t\t\t\ttextNode.setAttribute(\"transform\", \"scale(\" + (ratio / this.zoom) + \",\" + 1 + \")\");\n\t\t\t\ttextNode.setAttribute(\"x\", 0);\n\t\t\t\t//textNode.setAttribute(\"y\", textNode.getBBox().height / ratio);\n\n\t\t\t} else {\n\t\t\t\ttextNode.setAttribute(\"x\", (scaleInfo.rectWidth * this.zoom / 2 - scaleInfo.textWidth / 2));\n\t\t\t}\n\t\t}\n\n\t\ttextNode.setAttribute(\"opacity\", opacity);\n\t}\n};\n\nViewport.prototype.mouseWheel = function(e) {\n\tvar factor = 1.;\n\tif (e.deltaY > 0) {\n\t\tfactor = 1.4;\n\t} else {\n\t\tfactor = 1 / 1.4;\n\t}\n\te.preventDefault();\n\n\tvar rect = svg.getBoundingClientRect();\n\tvar mX = e.clientX - rect.left;\n\tvar w = svg.getBoundingClientRect().width;\n\tvar dx = mX / this.zoom;\n\tvar from = -this.centerX;\n\n\tthis.zoom *= factor;\n\n\tvar dx2 = mX / this.zoom;\n\tthis.centerX += (dx2 - dx);\n\tfrom = -this.centerX;\n\n\tthis.redraw(true, e);\n\treturn false;\n}\n","var Band = function(timeBand, height, name) {\n\tif (height !== undefined) {\n\t\tthis.height = height;\n\t} else {\n\t\tthis.height = timeBand.defaultBandHeight;\n\t}\n\tthis.yOffset = 0;\n\tthis.infos = {};\n\tthis.timeBand = timeBand;\n\ttimeBand.addBand(this);\n\tif (name !== undefined) {\n\t\tvar s = new TextBoxStyle();\n\t\ts.opacity = 0.8;\n\t\ts.strokeWidth = 0.5;\n\t\ts.bgfill = \"#fff\";\n\t\ts.fontSize = 20;\n\t\ts.textStroke = \"#fff\";\n\t\ts.textStrokeWidth = 0;\n\t\ts.textFill = \"#000\";\n\t\ts.rx = 5;\n\t\ts.ry = 5;\n\t\tvar bottom = this.timeBand.svg.getElementById('svgbottom');\n\t\tvar g = this.add(0, 8, name, s, undefined, bottom);\n\t\tvar rectNode = g.childNodes[0];\n\t\tvar textNode = g.childNodes[1];\n\t\tvar width = textNode.getBBox().width + 5;\n\t\trectNode.setAttribute(\"width\", width + 5);\n\t}\n};\n\nBand.prototype = {\n\tconstructor: Band,\n\n\tinit: function(canvasID) {\n\t\tthis.addListeners(canvasID);\n\t},\n\n\tadd: function(fromDay, toDay, text, style, hint, target) {\n\t\tif (target === undefined) {\n\t\t\ttarget = this.timeBand.top;\n\t\t}\n\t\tvar y = this.yOffset;\n\t\tvar h = this.height;\n\t\tif (style.section) {\n\t\t\ty -= this.yOffset;\n\t\t\th += this.yOffset;\n\t\t}\n\t\tvar groupElement = timebands.addBox(target,\n\t\t\tthis.timeBand.cellWidth * fromDay, y,\n\t\t\tthis.timeBand.cellWidth * (toDay - fromDay), h,\n\t\t\ttext, style, hint);\n\t\t\t\n\t\tthis.infos[groupElement] = \" Text: \" + text;\n\t\t\t\n\t\tif (target === this.timeBand.top) {\n\t\t\tthis.timeBand.scalableElements.push(groupElement);\n\t\t}\n\t\tvar self = this;\n\t\tgroupElement.addEventListener('click', function(e) {\n\t\t\tself.boxClicked(groupElement);\n\t\t});\n\t\t\t\t\n\t\tif (!style.section) {\n\t\t\tgroupElement.addEventListener('mouseover', function(e) {\n\t\t\t\tself.boxMouseover(groupElement);\n\t\t\t});\n\t\t\tgroupElement.addEventListener('mouseout', function(e) {\n\t\t\t\tself.boxMouseout(groupElement);\n\t\t\t});\n\t\t}\n\t\treturn groupElement;\n\t},\n\n\tboxClicked: function(e) {\n\t\tconsole.log(\"Clicked: \", this.infos[e]);\n\t},\n\n\tboxMouseover: function(e) {\n\t\tvar rectNode = e.childNodes[0];\n\t\tvar textNode = e.childNodes[1];\n\t\trectNode.style.stroke = \"red\";\n\t\trectNode.style.strokeWidth = \"2\";\n\n\t},\n\n\tboxMouseout: function(e) {\n\t\tvar rectNode = e.childNodes[0];\n\t\tvar textNode = e.childNodes[1];\n\t\trectNode.style.stroke = rectNode.style.originalStroke;\n\t\trectNode.style.stroke = \"black\";\n\t\trectNode.style.strokeWidth = \"0.2\";\n\t}\n\n}\n","var TimeBand = function(svg, startYear, startMonth, numberOfDays) {\n\n\tthis.view = new Viewport(svg);\n\tvar ne = document.createElementNS(\"http://www.w3.org/2000/svg\", 'defs'); \n\tvar l1=timebands.createLinearGradient(\"grad1\", \"0%\", \"30%\", \"0%\", \"100%\");\n\tl1.appendChild(timebands.createStop(\"0%\",\"stop-color:rgb(255,255,255);stop-opacity:1\"));\n\tl1.appendChild(timebands.createStop(\"100%\",\"stop-color:rgb(240,224,195);stop-opacity:1\"));\n\tvar l2=timebands.createLinearGradient(\"grad3\", \"0%\", \"30%\", \"0%\", \"100%\");\n\tl2.appendChild(timebands.createStop(\"0%\",\"stop-color:rgb(245,245,235);stop-opacity:1\"));\n\tl2.appendChild(timebands.createStop(\"100%\",\"stop-color:rgb(225,225,225);stop-opacity:1\"));\n\tvar l3=timebands.createLinearGradient(\"grad2\", \"0%\", \"30%\", \"0%\", \"100%\");\n\tl3.appendChild(timebands.createStop(\"0%\",\"stop-color:rgb(255,255,255);stop-opacity:1\"));\n\tl3.appendChild(timebands.createStop(\"100%\",\"stop-color:rgb(192,208,163);stop-opacity:1\"));\n\tne.appendChild(l1);\n\tne.appendChild(l2);\n\tne.appendChild(l3);\n\tsvg.appendChild(ne);\n\t\n\tvar ne2 = document.createElementNS(\"http://www.w3.org/2000/svg\", 'g'); \n\tne2.setAttribute(\"id\", \"svgtop\");\n\tvar ne3 = document.createElementNS(\"http://www.w3.org/2000/svg\", 'g'); \n\tne3.setAttribute(\"id\", \"svgbottom\");\n\tsvg.appendChild(ne2);\n\tsvg.appendChild(ne3);\n\t\n\n\tthis.startYear = startYear;\n\tthis.scalableElements = [];\n\tthis.numberOfDays = numberOfDays;\n\tthis.startMonth = startMonth;\n\tthis.defaultBandHeight = 20;\n\tthis.svg = svg;\n\tthis.cellWidth = 20;\n\tthis.top = svg.getElementById('svgtop');\n\tthis.nextYOffset = 0;\n\tthis.bands = [];\n};\n\nTimeBand.monthNames = [\"Jan\", \"Feb\", \"Mar\",\n\t\t\t\t \"Apr\", \"May\", \"Jun\", \"Jul\",\n\t\t\t\t\"Aug\", \"Sep\", \"Oct\",\n\t\t\t\t\"Nov\", \"Dec\"];\nTimeBand.monthColors2 = [\"#FC9\", \"#FEC\", \"#FC9\",\n\t\t\t\t\"#CDA\", \"#EED\", \"#CDA\",\n\t\t\t\t\"#FC9\", \"#FEC\", \"#FC9\",\n\t\t\t\t\"#CDA\", \"#EED\", \"#CDA\"];\nTimeBand.monthColors = [\"#EEE\", \"#FFF\", \"#EEE\",\n\t\t\t\t\"#FFF\", \"#EEE\", \"#FFF\",\n\t\t\t\t\"#EEE\", \"#FFF\", \"#EEE\",\n\t\t\t\t\"#FFF\", \"#EEE\", \"#FFF\"];\n\nTimeBand.prototype = {\n\tconstructor: TimeBand,\n\n\taddBand: function(band) {\n\t\tthis.bands.push(band);\n\t\tband.yOffset = this.nextYOffset;\n\t\tthis.nextYOffset += band.height;\n\t\tconsole.log(\"Added band \" + band + \". Current offset: \" + this.nextYOffset);\n\t},\n\t\n\taddHeader: function() {\n\t\tvar style = new TextBoxStyle();\n\t\tvar tb = this;\n\t\tvar months = [];\n\t\tvar weeks = [];\n\t\tvar weeksNumbers = [];\n\t\tvar lastMonth = -1;\n\t\tvar lastWeek = -1;\n\t\tvar days = new Band(tb,13);\n\t\tstyle.fontSize=10;\n\t\tfor (var x = 0; x < this.numberOfDays; x++) {\n\t\t\tvar d = new Date(tb.startYear,tb.startMonth,x+1) ;\n\t\t\tif (d.getMonth()!=lastMonth) {\n\t\t\t\tmonths.push(x);\n\t\t\t\tlastMonth = d.getMonth();\n\t\t\t}\n\t\t\tvar week = d.getWeekNumber();\n\t\t\tif (week!=lastWeek) {\n\t\t\t\tweeks.push(x);\n\t\t\t\tweeksNumbers.push(week);\n\t\t\t\tlastWeek = week;\n\t\t\t}\n\t\t\tdays.add(x,x+1, d.getDate(), style, d+\"\");\n\t\t}\n\t\tmonths.push(this.numberOfDays);\n\n\t\tstyle.fontSize=18;\n\n\t\tvar weeksBand = new Band(tb);\n\t\tfor (var i = 0; i < weeks.length-1; i++) {\n\t\t\tstyle.bgfill = (i % 2 == 1) ? \"none\" : \"#eee\";\n\t\t\tstyle.textFill = (i % 2 == 0) ? \"#fff\" : \"#fff\";\n\t\t\tconsole.log(\"Week \" + i + \" from \" + weeks[i] + \" to: \" + weeks[i+1]);\n\t\t\tweeksBand.add(weeks[i], weeks[i+1], weeksNumbers[i], style);\n\t\t}\n\t\t\n\t\tvar monthsBand = new Band(tb);\n\t\tfor (var i = 0; i < months.length-1; i++) {\n\t\t\tvar x = months[i];\n\t\t\tvar x2 = months[i+1];\n\t\t\tvar d = new Date(tb.startYear,tb.startMonth,x+1) ;\n\t\t\tstyle.bgfill = TimeBand.monthColors[d.getMonth()];\n\t\t\tmonthsBand.add(x, x2, TimeBand.monthNames[d.getMonth()], style);\n\t\t}\n\t}\n\t\n};\n","/**\n * @author Mikael Hvidtfeldt Christensen / twitter: @SyntopiaDK, web: hvidtfeldts.net\n */\n\nvar timebands = {\n    REVISION: '0.0.1'\n};\n\n\n\n/**\n * Taken from: http://stackoverflow.com/questions/3224834/get-difference-between-2-dates-in-javascript\n * (post by Shyam Habarakada)\n */\ntimebands.dateDiffInDays = function(a, b) {\n    // Discard the time and time-zone information.\n    var utc1 = Date.UTC(a.getFullYear(), a.getMonth(), a.getDate());\n    var utc2 = Date.UTC(b.getFullYear(), b.getMonth(), b.getDate());\n\n    return Math.floor((utc2 - utc1) / (1000 * 60 * 60 * 24)); // ms per day\n}\n\n/**\n * This functions was taken from RobG answer here:\n * http://stackoverflow.com/questions/6117814/get-week-of-year-in-javascript-like-in-php\n */\nDate.prototype.getWeekNumber = function() {\n    var d = new Date(+this);\n    d.setHours(0, 0, 0);\n    d.setDate(d.getDate() + 4 - (d.getDay() || 7));\n    return Math.ceil((((d - new Date(d.getFullYear(), 0, 1)) / 8.64e7) + 1) / 7);\n};\n\n\ntimebands.createLinearGradient = function(id,x1,y1,x2,y2) {\n\tvar ne = document.createElementNS(\"http://www.w3.org/2000/svg\", 'linearGradient'); \n\tne.setAttribute(\"id\",id);\n\tne.setAttribute(\"x1\",x1);\n\tne.setAttribute(\"y1\",y1);\n\tne.setAttribute(\"x2\",x2);\n\tne.setAttribute(\"y2\",y2);\n\treturn ne;\n}\n\ntimebands.createStop = function(offset,style) {\n\tvar ne = document.createElementNS(\"http://www.w3.org/2000/svg\", 'stop'); \n\tne.setAttribute(\"offset\",offset);\n\tne.setAttribute(\"style\",style);\n\treturn ne;\n}\n\n\ntimebands.addBox = function(svg, x, y, w, h, text, style, hint) {\n    var g = document.createElementNS(\"http://www.w3.org/2000/svg\", 'g');\n    g.setAttribute(\"transform\", \"translate(\" + x + \",\" + y + \")\");\n\n    var e = document.createElementNS(\"http://www.w3.org/2000/svg\", 'rect');\n    e.style.fill = style.bgfill;\n    e.style.stroke = \"black\";\n    e.style.originalStroke = e.style.stroke;\n    e.setAttribute(\"x\", 0);\n    e.setAttribute(\"y\", 0);\n    e.setAttribute(\"width\", w);\n    e.setAttribute(\"height\", h);\n    e.setAttribute(\"rx\", style.rx);\n    e.setAttribute(\"ry\", style.ry);\n    e.style.strokeWidth = style.strokeWidth;\n    e.style.originalStrokeWidth = e.style.strokeWidth;\n    e.style.opacity = style.opacity;\n\n    var t = document.createElementNS(\"http://www.w3.org/2000/svg\", 'text');\n    t.setAttribute(\"x\", 5);\n    t.setAttribute(\"transform\", \"scale(1,1)\");\n    t.style.fontfamily = \"Helvetica\";\n    t.setAttribute(\"y\", h - 3);\n    t.setAttribute(\"font-size\", style.fontSize);\n    g.setAttribute(\"alignment-baseline\", \"baseline\");\n    t.textContent = text;\n    g.appendChild(e);\n    g.appendChild(t);\n\n    if (hint !== undefined) {\n        var ti = document.createElementNS(\"http://www.w3.org/2000/svg\", 'title');\n        ti.textContent = hint;\n        g.appendChild(ti);\n    }\n\n    if (svg.hasChildNodes() && svg.children !== undefined) {\n        svg.insertBefore(g, svg.children[0]);\n    } else {\n        svg.appendChild(g);\n    }\n    return g;\n};\n\n\ntimebands.init = function(svg, defs, startYear, startMonth, numberOfDays) {\n\tvar startDate = new Date(startYear,startMonth-1,1);\n\tsvg.setAttribute(\"style\", \"font-family: Helvetica, Arial;-webkit-user-select: none; -moz-user-select: none; -ms-user-select: none;\");\n\t\n\tvar tb = new TimeBand(svg,startYear,startMonth-1, numberOfDays);\n\ttb.addHeader();\n\tvar spacing = 7;\n\tvar height = 30;\n\n\tvar ss = new TextBoxStyle();\n\tss.fontSize = 20;\n\tss.rx = 3;\n\tss.ry = 3;\n\tss.bgfill = \"url(#grad3)\";\n\t\n\tvar parser = new TimeBandsParser();\n\tparser.parse(defs.innerHTML);\n\tfor (var i = 0; i < parser.bandSections.length; i++) {\n\t\tvar bs = parser.bandSections[i];\n\t\tnew Band(tb,spacing);\n\t\tif (bs.name.startsWith(\"!\")) {\n\t\t\tss.section = true;\n\t\t\tb = new Band(tb,height, bs.name.substr(1));\t\t\n\t\t} else {\n\t\t\tb = new Band(tb,height, bs.name);\t\t\n\t\t}\n\t\tfor (var j = 0; j < bs.entries.length; j++) {\n\t\t\tif (ss.section) ss.bgfill = (j % 2 == 0) ? \"url(#grad1)\" : \"url(#grad2)\";\n\t\t\tvar e = bs.entries[j];\n\t\t\tvar interval = e.getIntervalRelativeToDate(startDate);\n\t\t\tb.add(interval[0],interval[1]+1, e.name, ss);\n\t\t}\n\t}\n\ttb.view.scalableElements = tb.scalableElements;\n}\n\ntimebands.create = function(svgID, defsID, startYear, startMonth, numberOfDays) {\n\tsvg = document.getElementById(svgID);\n\tdefs = document.getElementById(defsID);\n\ttimebands.init(svg,defs, startYear, startMonth, numberOfDays);\n\tsvg.addEventListener(\"load\",function() {\n\t\ttimebands.init(svg,defs, startYear, startMonth, numberOfDays);\n\t}, false);\n}\n\n\n","var BandEntry = function(name, from, to) {\r\n\tthis.name = name;\r\n\tthis.from = from;\r\n\tthis.to = to;\r\n\t\r\n\tthis.getIntervalRelativeToDate = function(date) {\r\n\t\tvar f = timebands.dateDiffInDays(date, from);\r\n\t\tvar t = timebands.dateDiffInDays(date, to);\r\n\t\treturn [f,t];\r\n\t}\r\n}\r\n\r\nvar BandSection = function(name) {\r\n\tthis.name = name;\r\n\tthis.entries = []; // of type BandEntry\r\n\tthis.toString = function() {\r\n\t\treturn \"BandSection[\" + name + \"]: \" + this.entries.length + \" + entries\";\r\n\t};\r\n\tthis.addEntry = function(e) {\r\n\t\tconsole.log(\"Added entry: \" + e);\r\n\t\tthis.entries.push(e);\r\n\t};\r\n}\r\n\r\n\r\nvar TimeParser = function(implicitYear) {\r\n\tthis.implicitYear = implicitYear;\r\n}\r\n\r\nTimeParser.prototype = {\r\n\tparseInterval: function(b) {\r\n\t\tvar l = b.split(\"-\");\r\n\t\tif (l.length != 2) {\r\n\t\t\tthrow \"The date interval [\" + b + \"] did not contain exactly one hyphen\";\r\n\t\t}\r\n\t\tvar from = this.parseTime(l[0]);\r\n\t\tvar to = this.parseTime(l[1]);\r\n\t\treturn [from,to];\r\n\t},\r\n\t\r\n\tparseTime: function(b) {\r\n\t\tb = b.trim();\r\n\t\tvar l = b.split(\"/\");\r\n\t\tvar date;\r\n\t\tif (l.length == 2) {\r\n\t\t\tdate = new Date(this.implicitYear, l[1]-1, l[0]);\r\n\t\t} else if (l.length == 3) {\r\n\t\t\tvar y = l[2];\r\n\t\t\tif (y<100) y+=2000; // two-digit year\r\n\t\t\tdate = new Date(y, l[1]-1, l[0]);\r\n\t\t} else {\r\n\t\t\tthrow \"The date [\" + b + \"] did not contain one or two /-es\";\r\n\t\t}\r\n\t\tconsole.log(\"Parsed date: \" + date);\r\n\t\treturn date;\r\n\t}\r\n}\r\n\r\nvar TimeBandsParser = function() {\r\n\tthis.bandSections = []; // of type BandSection\r\n\tthis.timeParser = new TimeParser(2015);\r\n}\r\n\r\nTimeBandsParser.prototype = {\r\n\taddBandSection: function(b) {\r\n\t\tif (b === undefined) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.bandSections.push(b);\r\n\t\tconsole.log(\"New section:\" + b.toString());\r\n\t},\r\n\t\r\n\tparseEntry: function(b) {\r\n\t\tvar l = b.split(\":\");\r\n\t\tif (l.length != 2) {\r\n\t\t\tthrow \"The entry [\" + b + \"] did not contain exactly one colon\";\r\n\t\t}\r\n\t\tvar interval = this.timeParser.parseInterval(l[0]);\r\n\t\tvar name = l[1];\r\n\t\tvar e = new BandEntry(name, interval[0], interval[1]);\r\n\t\treturn e;\r\n\t},\r\n\t\r\n\tparse: function(txt) {\r\n\t\tvar lines = txt.match(/[^\\r\\n]+/g);\r\n\t\tvar bandSection = undefined;\r\n\t\tfor (var i = 0; i < lines.length; i++) {\r\n\t\t\tif (i<lines.length-1) {\r\n\t\t\t\tif (lines[i+1].startsWith(\"---\")) {\r\n\t\t\t\t\tbandSection = new BandSection(lines[i]);\r\n\t\t\t\t\tthis.addBandSection(bandSection);\r\n\t\t\t\t\ti++;\r\n\t\t\t\t\tcontinue;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tconsole.log(i + \" \" + lines[i]);\r\n\t\t\tif (bandSection === undefined) {\r\n\t\t\t\tthrow \"When parsing [\" + lines[i] + \"] no section was defined\";\r\n\t\t\t}\r\n\t\t\tvar e = this.parseEntry(lines[i]);\r\n\t\t\tbandSection.addEntry(e);\r\n\t\t}\r\n\t}\r\n}\r\n\t"],"sourceRoot":"/source/"}